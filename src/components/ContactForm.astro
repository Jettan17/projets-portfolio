---
interface Props {
  formAction?: string;
}

const { formAction = 'https://formspree.io/f/your-form-id' } = Astro.props;
---

<form class="contact-form" action={formAction} method="POST">
  <div class="form-group">
    <label for="name" class="form-label">Name</label>
    <input
      type="text"
      id="name"
      name="name"
      class="form-input"
      placeholder="Your name"
      required
    />
  </div>

  <div class="form-group">
    <label for="email" class="form-label">Email</label>
    <input
      type="email"
      id="email"
      name="email"
      class="form-input"
      placeholder="your@email.com"
      required
    />
  </div>

  <div class="form-group">
    <label for="subject" class="form-label">Subject</label>
    <input
      type="text"
      id="subject"
      name="subject"
      class="form-input"
      placeholder="What's this about?"
      required
    />
  </div>

  <div class="form-group">
    <label for="message" class="form-label">Message</label>
    <textarea
      id="message"
      name="message"
      class="form-input form-textarea"
      placeholder="Your message..."
      rows="6"
      required
    ></textarea>
  </div>

  <button type="submit" class="form-submit">
    <span class="submit-text">Send Message</span>
    <span class="submit-icon">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
        <line x1="22" y1="2" x2="11" y2="13"></line>
        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
      </svg>
    </span>
  </button>
</form>

<style>
  .contact-form {
    display: flex;
    flex-direction: column;
    gap: var(--space-6);
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .form-label {
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    color: var(--text-primary);
  }

  .form-input {
    width: 100%;
    padding: var(--space-3) var(--space-4);
    font-family: var(--font-body);
    font-size: var(--text-base);
    color: var(--text-primary);
    background: var(--bg-primary);
    border: 2px solid var(--bg-tertiary);
    border-radius: var(--radius-lg);
    transition: all var(--transition-fast);
  }

  .form-input::placeholder {
    color: var(--text-tertiary);
  }

  .form-input:hover {
    border-color: var(--text-tertiary);
  }

  .form-input:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.15);
  }

  .form-textarea {
    resize: vertical;
    min-height: 150px;
  }

  .form-submit {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding: var(--space-4) var(--space-8);
    font-family: var(--font-body);
    font-size: var(--text-base);
    font-weight: var(--font-semibold);
    color: var(--text-light);
    background: var(--gradient-primary);
    border: none;
    border-radius: var(--radius-lg);
    cursor: pointer;
    box-shadow: var(--shadow-primary);
    transition: all var(--transition-fast);
  }

  .form-submit:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(255, 107, 107, 0.5);
  }

  .form-submit:active {
    transform: translateY(0);
  }

  .form-submit:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }

  .submit-icon {
    display: flex;
    transition: transform var(--transition-fast);
  }

  .form-submit:hover .submit-icon {
    transform: translateX(4px);
  }

  /* Success/Error states (for JS enhancement) */
  .form-input.error {
    border-color: var(--color-primary);
  }

  .form-input.success {
    border-color: var(--color-secondary);
  }
</style>

<script>
  const form = document.querySelector('.contact-form') as HTMLFormElement;

  if (form) {
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const submitBtn = form.querySelector('.form-submit') as HTMLButtonElement;
      const originalText = submitBtn.querySelector('.submit-text')?.textContent;

      // Update button state
      submitBtn.disabled = true;
      const submitText = submitBtn.querySelector('.submit-text');
      if (submitText) submitText.textContent = 'Sending...';

      try {
        const formData = new FormData(form);
        const response = await fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });

        if (response.ok) {
          if (submitText) submitText.textContent = 'Message Sent!';
          form.reset();

          // Reset button after delay
          setTimeout(() => {
            if (submitText && originalText) submitText.textContent = originalText;
            submitBtn.disabled = false;
          }, 3000);
        } else {
          throw new Error('Form submission failed');
        }
      } catch {
        if (submitText) submitText.textContent = 'Error - Try Again';
        submitBtn.disabled = false;

        setTimeout(() => {
          if (submitText && originalText) submitText.textContent = originalText;
        }, 3000);
      }
    });
  }
</script>
