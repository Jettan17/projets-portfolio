---
import BaseLayout from '../../layouts/BaseLayout.astro';
import ProjectGrid from '../../components/ProjectGrid.astro';
import { getCollection } from 'astro:content';
import { getGitHubProjects, mergeProjects } from '../../utils/projects';

// Fetch both markdown and GitHub projects
const markdownProjects = await getCollection('projects');
const githubProjectsList = await getGitHubProjects();

// Merge and sort all projects by date
const allProjects = mergeProjects(
  markdownProjects.map(p => ({
    slug: p.slug,
    data: { ...p.data, source: 'markdown' as const },
  })),
  githubProjectsList
);
---

<BaseLayout
  title="Projects"
  description="Browse my portfolio of web development projects showcasing creativity and technical skill."
>
  <section class="section projects-page">
    <div class="container">
      <div class="page-header">
        <h1 class="page-title">
          My <span class="gradient-text">Projects</span>
        </h1>
        <p class="page-description">
          A collection of my work, ranging from personal experiments to full-featured applications.
          Each project represents a unique challenge and creative solution.
        </p>
      </div>

      <ProjectGrid projects={allProjects} />
    </div>
  </section>
</BaseLayout>

<style>
  .projects-page {
    min-height: calc(100vh - var(--header-height));
  }

  .page-header {
    text-align: center;
    margin-bottom: var(--space-12);
  }

  .page-title {
    font-size: clamp(2rem, 5vw, 3.5rem);
    margin-bottom: var(--space-4);
  }

  .page-description {
    font-size: var(--text-lg);
    color: var(--text-secondary);
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }
</style>
